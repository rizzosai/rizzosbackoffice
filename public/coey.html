<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coey AI Assistant - Rizzos Backoffice</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background-color: #f4f4f4; 
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 0 10px rgba(0,0,0,0.1); 
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            padding-bottom: 20px; 
            border-bottom: 2px solid #007bff; 
        }
        .chat-container {
            height: 500px;
            border: 2px solid #007bff;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .chat-header {
            background: #007bff;
            color: white;
            padding: 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }
        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 10px;
            max-width: 80%;
        }
        .message.user {
            background: #007bff;
            color: white;
            margin-left: auto;
            text-align: right;
        }
        .message.coey {
            background: white;
            border: 1px solid #ddd;
            margin-right: auto;
        }
        .chat-input-container {
            padding: 15px;
            background: white;
            border-top: 1px solid #ddd;
            display: flex;
            gap: 10px;
        }
        .chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .send-button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .send-button:hover {
            background: #0056b3;
        }
        .nav-menu { 
            display: flex; 
            justify-content: center; 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .nav-button { 
            padding: 10px 20px; 
            background-color: #007bff; 
            color: white; 
            text-decoration: none; 
            border-radius: 5px; 
        }
        .nav-button:hover { 
            background-color: #0056b3; 
        }
        .coey-features {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .coey-features h3 {
            color: #007bff;
            margin-top: 0;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .feature-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .typing-indicator {
            display: none;
            color: #666;
            font-style: italic;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ¤– Coey AI Assistant</h1>
            <p>Your Personal Business Intelligence Assistant</p>
        </div>

        <div class="nav-menu">
            <a href="/admin" class="nav-button">Admin Dashboard</a>
            <a href="/domain-check" class="nav-button">Domain Check</a>
            <a href="/logout" class="nav-button">Logout</a>
        </div>

        <div class="coey-features">
            <h3>ðŸŽ¯ What Coey Can Help You With</h3>
            <div class="feature-grid">
                <div class="feature-item">
                    <strong>ðŸ“Š Business Analytics</strong><br>
                    Get insights on your domain performance, revenue, and referrals
                </div>
                <div class="feature-item">
                    <strong>ðŸŽ“ Guide Assistance</strong><br>
                    Ask questions about your training guides and implementation
                </div>
                <div class="feature-item">
                    <strong>ðŸ’¡ Strategy Advice</strong><br>
                    Get personalized recommendations for growing your business
                </div>
                <div class="feature-item">
                    <strong>ðŸ”§ Technical Support</strong><br>
                    Help with domain setup, backoffice features, and troubleshooting
                </div>
            </div>
        </div>

        <div class="chat-container">
            <div class="chat-header">
                <span>ðŸ¤–</span>
                <span>Coey - Your AI Business Assistant</span>
                <span style="margin-left: auto; font-size: 0.9em;">Online</span>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message coey">
                    <strong>Coey:</strong> Hello! I'm Coey, your AI business assistant. I'm here to help you succeed with your RizzosAI domain business. How can I assist you today?
                </div>
            </div>
            
            <div class="typing-indicator" id="typingIndicator">
                Coey is typing...
            </div>
            
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask Coey anything about your business..." />
                <button class="send-button" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <script>
        let chatMessages = document.getElementById('chatMessages');
        let chatInput = document.getElementById('chatInput');
        let typingIndicator = document.getElementById('typingIndicator');

        // Handle Enter key
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        async function sendMessage() {
            let message = chatInput.value.trim();
            if (!message) return;

            // Add user message
            addMessage(message, 'user');
            chatInput.value = '';

            // Show typing indicator
            showTyping();

            try {
                // Send to backend
                const response = await fetch('/coey/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });

                const data = await response.json();
                
                // Hide typing indicator
                hideTyping();
                
                // Add Coey's response
                addMessage(data.response, 'coey');
                
            } catch (error) {
                hideTyping();
                addMessage('Sorry, I encountered an error. Please try again.', 'coey');
            }
        }

        function addMessage(text, sender) {
            let messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            if (sender === 'coey') {
                messageDiv.innerHTML = `<strong>Coey:</strong> ${text}`;
            } else {
                messageDiv.innerHTML = text;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTyping() {
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTyping() {
            typingIndicator.style.display = 'none';
        }

        // Sample responses for demo (replace with actual AI integration)
        const sampleResponses = [
            "Based on your current package, I recommend focusing on implementing the Traffic Secrets guide first. This will help you get immediate results.",
            "Your domain performance looks good! I suggest exploring the Facebook Ads strategies from your Pro guides to scale up.",
            "I can help you with that! Let me break down the steps from your business guides...",
            "Great question! According to your Elite package guides, here's what I recommend...",
            "I see you're working on scaling your business. Have you implemented the automation strategies from your guides yet?"
        ];

        // Demo mode - remove this when integrating with real AI
        if (window.location.search.includes('demo=true')) {
            window.sendMessage = async function() {
                let message = chatInput.value.trim();
                if (!message) return;

                addMessage(message, 'user');
                chatInput.value = '';
                showTyping();

                setTimeout(() => {
                    hideTyping();
                    let randomResponse = sampleResponses[Math.floor(Math.random() * sampleResponses.length)];
                    addMessage(randomResponse, 'coey');
                }, 1500);
            }
        }
    </script>
</body>
</html>